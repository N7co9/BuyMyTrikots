<?php

namespace Controller;

use App\Controller\ClientLoginController;
use App\Controller\ClientLogoutController;
use App\Core\DependencyProvider;
use App\Core\Redirect\RedirectSpy;
use App\Core\SQL\SqlConnector;
use PHPUnit\Framework\TestCase;
use App\Core\Container;

class ClientLogoutControllerTest extends TestCase
{
    public RedirectSpy $redirectSpy;
    protected function setUp(): void
    {
        $this->redirectSpy = new RedirectSpy();
        $this->construct = new ClientLogoutController();
        parent::setUp();
    }

    public function testDataConstruct(): void
    {
        session_start();
        $id = session_id();
        $this->construct->dataConstruct();
        $newId = session_id();
        self::assertNotSame($newId, $id);
        self::assertContains('http://localhost:8000/?page=shop', $this->construct->redirectSpy->capturedHeaders);
    }
    public function tearDown(): void
    {
        $connector = new SqlConnector();
        $connector->closeConnection();
        parent::tearDown();
        parent::tearDown(); // TODO: Change the autogenerated stub
    }
}